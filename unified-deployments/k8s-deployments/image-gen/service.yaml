apiVersion: v1
kind: Service
metadata:
  name: image-gen
  namespace: image-gen
  labels:
    app.kubernetes.io/name: image-gen
  annotations:
    metallb.universe.tf/loadBalancerIPs: "192.168.86.210"  # Dedicated IP from MetalLB pool
spec:
  type: LoadBalancer
  selector:
    app: image-gen
  ports:
    - name: http
      port: 80
      targetPort: 7860
      protocol: TCP
  sessionAffinity: None  # Round-robin load balancing
---
# Internal service for cluster access
apiVersion: v1
kind: Service
metadata:
  name: image-gen-internal
  namespace: image-gen
  labels:
    app.kubernetes.io/name: image-gen
spec:
  type: ClusterIP
  selector:
    app: image-gen
  ports:
    - name: http
      port: 7860
      targetPort: 7860
      protocol: TCP
---
# Headless service for direct pod access
apiVersion: v1
kind: Service
metadata:
  name: image-gen-headless
  namespace: image-gen
  labels:
    app.kubernetes.io/name: image-gen
spec:
  type: ClusterIP
  clusterIP: None
  selector:
    app: image-gen
  ports:
    - name: http
      port: 7860
      targetPort: 7860
